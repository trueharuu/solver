const weights = {
  IJL: [0, 0, 10398568, 10398432, 0, 0, 0],
  IJO: [24931, 10007584, 0, 0, 10726944, 10982636, 11202480],
  IJS: [25863, 10515396, 0, 0, 10696580, 11120568, 15156723],
  TIJ: [0, 12349, 932, 0, 20038, 24698, 17242],
  IJZ: [6524, 10804226, 0, 0, 10957248, 11818226, 12647493],
  ILO: [24232, 10006160, 0, 0, 10726656, 11202754, 10981252],
  ILS: [6291, 10803378, 0, 0, 10954972, 12631499, 11823071],
  TIL: [0, 12349, 0, 932, 20038, 16077, 24232],
  ILZ: [26096, 10505420, 0, 0, 10696480, 15162554, 11117844],
  IOS: [12116, 35472, 10849732, 11177734, 11184, 279075, 28760],
  TIO: [16543, 12582, 28426, 26795, 9320, 12815, 13281],
  IOZ: [12582, 35448, 11178080, 10848064, 11184, 28764, 278935],
  TIS: [0, 26096, 24232, 15844, 2330, 165630, 157157],
  ISZ: [212764, 13980, 11647222, 11653843, 0, 1200974, 1199890],
  TIZ: [0, 26096, 17242, 24698, 2330, 157161, 165638],
  JLO: [1864, 0, 10558368, 10558584, 0, 0, 0],
  JLS: [1864, 0, 10843520, 10800752, 0, 233, 0],
  TJL: [0, 0, 23300, 23300, 2796, 1864, 1864],
  JLZ: [1864, 0, 10801604, 10843376, 0, 0, 233],
  JOS: [63130, 10955656, 0, 0, 116135116, 61090396, 30380699],
  TJO: [0, 24931, 2563, 1398, 102054, 81181, 56127],
  JOZ: [51577, 11061464, 0, 0, 78420326, 30380260, 179779748],
  TJS: [0, 19805, 1864, 0, 57784, 208716, 85718],
  JSZ: [50781, 15225615, 0, 0, 27413735, 140479460, 178002735],
  TJZ: [0, 17242, 0, 932, 33552, 91530, 362698],
  LOS: [51597, 11060720, 0, 0, 78418086, 178739665, 30377899],
  TLO: [0, 23999, 1398, 2563, 102054, 56143, 80715],
  LOZ: [61033, 10955776, 0, 0, 116133036, 30378156, 61130329],
  TLS: [0, 16776, 932, 0, 33552, 363903, 90843],
  LSZ: [51946, 15227702, 0, 0, 27411224, 171629324, 81066019],
  TLZ: [0, 20038, 0, 1864, 57318, 87594, 212088],
  TOS: [29715, 8621, 74657, 61150, 393198, 590116, 800057],
  OSZ: [860156, 20244, 19512102, 19511239, 799564, 5065103, 5071639],
  TOZ: [29719, 8621, 61130, 73958, 393166, 800081, 590300],
  TSZ: [45248, 148454, 96423, 93643, 564792, 997153, 996773],
  "": [0, 233, 813, 809, 2623, 7162, 7165],
  IJLO: [0, 0, 0, 0, 0, 0, 0],
  IJLS: [0, 0, 0, 0, 0, 16, 115],
  TIJL: [0, 0, 0, 0, 0, 0, 0],
  IJLZ: [0, 0, 0, 0, 0, 113, 16],
  IJOS: [0, 5, 0, 0, 20, 645, 1285],
  TIJO: [0, 0, 0, 0, 0, 0, 0],
  IJOZ: [0, 4, 40, 0, 303, 1187, 803],
  TIJS: [0, 0, 0, 0, 0, 0, 0],
  IJSZ: [0, 312, 0, 16, 1167, 2542, 2652],
  TIJZ: [0, 0, 0, 0, 0, 0, 0],
  ILOS: [0, 4, 0, 41, 303, 801, 1188],
  TILO: [0, 0, 0, 0, 0, 0, 0],
  ILOZ: [0, 5, 0, 0, 20, 1283, 646],
  TILS: [0, 0, 0, 0, 0, 0, 0],
  ILSZ: [0, 322, 18, 0, 1167, 2640, 2542],
  TILZ: [0, 0, 0, 0, 0, 0, 0],
  TIOS: [0, 0, 0, 0, 0, 0, 0],
  IOSZ: [0, 7312, 771, 768, 8372, 8517, 8517],
  TIOZ: [0, 0, 0, 0, 0, 0, 0],
  TISZ: [0, 0, 0, 0, 0, 0, 0],
  JLOS: [0, 0, 0, 40, 252, 693, 335],
  TJLO: [0, 0, 0, 0, 0, 0, 0],
  JLOZ: [0, 0, 40, 0, 252, 335, 695],
  TJLS: [0, 0, 0, 0, 0, 0, 0],
  JLSZ: [0, 112, 16, 16, 86, 1399, 1399],
  TJLZ: [0, 0, 0, 0, 0, 0, 0],
  TJOS: [0, 0, 0, 0, 0, 0, 0],
  JOSZ: [0, 1302, 411, 298, 5137, 9536, 6964],
  TJOZ: [0, 0, 0, 0, 0, 0, 0],
  TJSZ: [0, 0, 0, 0, 0, 0, 0],
  TLOS: [0, 0, 0, 0, 0, 0, 0],
  LOSZ: [0, 1302, 298, 418, 5201, 6964, 9502],
  TLOZ: [0, 0, 0, 0, 0, 0, 0],
  TLSZ: [0, 0, 0, 0, 0, 0, 0],
  TOSZ: [0, 0, 0, 0, 32, 6, 6],
  I: [23167272, 28474473, 27180665, 27171863, 28470254, 34885179, 34891802],
  J: [23076745, 27180665, 28196395, 28424876, 28122070, 39440314, 41952353],
  L: [23073472, 27171863, 28424876, 28193428, 28105376, 41770671, 39368800],
  O: [23515198, 28470254, 28122070, 28105376, 37546911, 45748992, 45731512],
  S: [24551112, 34885179, 39440314, 41770671, 45748992, 265272682, 224724915],
  T: [29412127, 23167272, 23076745, 23073472, 23515198, 24551112, 24516806],
  Z: [24516806, 34891802, 41952353, 39368800, 45731512, 224724915, 265713652],
  IJLOS: [35, 830, 137, 151, 1869, 5864, 7764],
  TIJLO: [0, 0, 0, 0, 0, 9, 8],
  IJLOZ: [39, 832, 145, 135, 1857, 7750, 5864],
  TIJLS: [0, 0, 0, 0, 3, 0, 3],
  IJLSZ: [52, 3344, 119, 119, 6514, 11067, 11112],
  TIJLZ: [0, 0, 0, 0, 3, 3, 0],
  TIJOS: [1, 0, 6, 23, 0, 28, 189],
  IJOSZ: [426, 5450, 8988, 7942, 9395, 23271, 15575],
  TIJOZ: [0, 0, 62, 25, 0, 257, 104],
  TIJSZ: [0, 0, 82, 39, 50, 259, 63],
  TILOS: [0, 0, 20, 58, 0, 104, 258],
  ILOSZ: [425, 5439, 7901, 8987, 9389, 15556, 23256],
  TILOZ: [1, 0, 29, 6, 0, 188, 30],
  TILSZ: [0, 0, 39, 80, 48, 62, 257],
  TIOSZ: [370, 3226, 93, 91, 5178, 5532, 5516],
  TJLOS: [0, 0, 0, 0, 24, 139, 228],
  JLOSZ: [1029, 8135, 1524, 1524, 14382, 35220, 35206],
  TJLOZ: [0, 0, 0, 0, 24, 139, 228],
  TJLSZ: [0, 4, 0, 0, 160, 131, 133],
  TJOSZ: [64, 175, 452, 828, 664, 2271, 1072],
  TLOSZ: [64, 178, 827, 454, 664, 1072, 2267],
  IJ: [60566445, 68912403, 92103195, 92009940, 69595502, 71727845, 73213418],
  IL: [60564871, 68921083, 92010127, 92104835, 69596605, 73226100, 71717285],
  IO: [64505166, 93144695, 69751138, 69753968, 94896722, 95387480, 95390602],
  IS: [67585101, 97180250, 71546359, 73092931, 95268275, 101300868, 100842912],
  TI: [60836912, 62238378, 60565962, 60564832, 64268765, 67182535, 67224861],
  IZ: [67597821, 97184893, 73080240, 71537878, 95271667, 100843110, 101333629],
  JL: [63860178, 91961507, 69494675, 69494198, 92617960, 92801607, 92800505],
  JO: [62811640, 69779304, 92956226, 92624010, 73185211, 76193154, 78313984],
  JS: [64798930, 71703704, 92684817, 92779734, 75467616, 82010295, 80189107],
  TJ: [61837778, 60137581, 63549277, 63776811, 62586012, 64579315, 66304548],
  JZ: [66095741, 72953822, 94056115, 92709392, 77959394, 80099739, 89660874],
  LO: [62813879, 69784613, 92624162, 92955169, 73182352, 78312148, 76134528],
  LS: [66114052, 72965153, 92712781, 93951135, 77957370, 89671588, 80050985],
  TL: [61832248, 60137925, 63774991, 63556054, 62578772, 66312161, 64568437],
  LZ: [64790022, 71691593, 92777557, 92691422, 75375670, 80153973, 81998787],
  OS: [70091335, 95360107, 76117886, 78277794, 101957288, 104548790, 106940166],
  TO: [61491384, 64477397, 62537120, 62545133, 69937262, 70053337, 70008446],
  OZ: [70041129, 95363575, 78280516, 76053460, 101949414, 106939611, 104540408],
  TS: [64820491, 67270098, 64004757, 65819749, 69626684, 86094926, 74400725],
  SZ: [
    75044654, 100744308, 79514600, 79485618, 106635579, 110313034, 110317918,
  ],
  TZ: [64820924, 67287946, 65815107, 64000359, 69576435, 74398069, 86060468],
  TIJLOS: [0, 24, 68, 82, 109, 668, 1238],
  IJLOSZ: [4039, 14883, 14329, 14273, 24412, 52796, 52734],
  TIJLOZ: [0, 23, 82, 71, 108, 1225, 674],
  TIJLSZ: [0, 24, 130, 130, 1118, 1016, 1015],
  TIJOSZ: [496, 2502, 2776, 2526, 4743, 13216, 8675],
  TILOSZ: [491, 2498, 2530, 2709, 4741, 8653, 13266],
  TJLOSZ: [24, 1216, 1488, 1488, 3712, 4729, 4727],
};

const remaining_pieces = [4, 1, 5, 2, 6, 3, 7];
const pieces_used = [3, 6, 2, 5, 1, 4, 0];
const pieces = ["T", "I", "J", "L", "O", "S", "Z"];
function get_raw_save(sol) {
  const queue = document.getElementById("queue").value;
  const queue_pieces = pieces.map((piece) => {
    return queue.split(piece).length - 1;
  });

  if (document.querySelectorAll(".pc.on").length === 0) {
    return "";
  }
  const pc_num = Number(
    document.querySelectorAll(".pc.on")[0].id.split("-")[2],
  );

  const sol_pieces = pieces.map((piece) => {
    return (sol.split(piece).length - 1) / 4;
  });

  let different_index = -1;
  for (let i = 0; i < queue_pieces.length; i++) {
    if (queue_pieces[i] !== sol_pieces[i]) {
      different_index = i;
    }
  }

  const bag = new Set(["T", "I", "J", "L", "O", "S", "Z"]);
  const current_pc_num = pc_num - 1;

  let save;
  let nth = "";
  if (different_index !== -1) {
    for (let j = 1; j < pieces_used[current_pc_num] + 2; j++) {
      bag.delete(queue[queue.length - j]);
    }

    save = Array.from(bag).join("");

    save += pieces[different_index];

    save = sort(save);
  } else {
    for (let j = 1; j < pieces_used[current_pc_num] + 1; j++) {
      bag.delete(queue[queue.length - j]);
    }

    save = Array.from(bag).join("");
  }

  return save;
}
